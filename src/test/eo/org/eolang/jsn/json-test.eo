+package org.eolang.jsn
+alias org.eolang.jsn.create-json
+alias org.eolang.hamcrest.assert-that
+alias org.eolang.collections.list
+alias org.eolang.collections.map
+junit

[] > with-do-not-crush
  create-json > j1!
  (j1.with-int 0 0).with-int 1 1 > j2!
  eq. > @
    j2.size
    2

[] > with-int-and-find
  create-json > j1!
  (j1.with-int "key12" 42).with-int "key2" -12 > j2!
  assert-that > @
    * (j2.size) ((j2.find "key12").at 0)
    $.equal-to
      list
        * 2 42

[] > with-json-and-with-int
  create-json > init!
  (init.with-int "a" 18).with-int "w" 65 > j-person!
  (init.with-json "he" j-person) > jres!
  assert-that > @
    * (jres.size) (((jres.find "he").at 0).size) ((jres.find "json").length)
    $.equal-to
      list
        * 1 2 0

[] > with-json-and-with-map
  create-json > init!
  (map *).with "key" "value" > mp!
  (init.with-int "a" 18).with-int "map" mp > j-person!
  (init.with-json "he" j-person) > jres!
  assert-that > @
    * (jres.size) (((jres.find "he").at 0).size) ((((((jres.find "he").at 0).find "map").at 0).found "key").at 0)
    $.equal-to
      list
        * 1 2 "value"

[] > type-float-test
  create-json.with-float 42 0.42 > j!
  assert-that > @
    * ((j.find 42).at 0) (j.type-by-key 42)
    $.equal-to
      list
        * 0.42 1

[] > type-string-test
  create-json.with-string 42 "abacaba" > j!
  assert-that > @
    * ((j.find 42).at 0) (j.type-by-key 42)
    $.equal-to
      list
        * "abacaba" 2

[] > type-array-test
  create-json.with-array 42 (* 1 2 3) > j!
  assert-that > @
    * (((j.find 42).at 0).at 0) (((j.find 42).at 0).at 1) (((j.find 42).at 0).at 2) (j.type-by-key 42)
    $.equal-to
      list
        * 1 2 3 3
